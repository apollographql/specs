<!DOCTYPE html>
<!-- Built with spec-md https://spec-md.com -->
<html>
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1"><title>Join</title>
<style>
:root {
  color: #333333;
  font-family: var(--body-font-family);
  font-size: 15px;
  line-height: 1.5;
  --body-font-family: Cambria, "Palatino Linotype", Palatino, "Liberation Serif", serif;
  --mono-font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --mono-font-size: 13px;
  --indent: 1rem;
  --list-indent: 1.5rem;
  --grammar-indent: 0rem;
  --highlight-background: #FBF8D0;
  --highlight-border-color: transparent;
  --sidebar-width: min(320px, calc(100vw - 48px));
}

@media (min-width: 720px) {
  :root {
    font-size: 17px;
    --mono-font-size: 15px;
    --indent: 2rem;
    --list-indent: 2rem;
    --grammar-indent: 2rem;
  }
}

body {
  margin: 3rem 0 3rem;
}

article {
  margin: 0 auto;
}

@media (min-width: 720px) {
  body {
    margin: 6rem auto 3rem;
    padding-left: 75px;
    padding-right: clamp(0px, calc((100vw - 800px) * 0.25), 75px);
  }

  article {
    max-width: 800px;
  }
}

/* Selections */

.outdated-selection-link,
.selection-link {
  position: absolute;
  display: block;
  color: #fff;
  background-color: #cacee0;
  border-radius: 4px;
  font-size: 36px;
  height: 23px;
  line-height: 48px;
  text-align: center;
  text-decoration: none;
  width: 25px;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}

.outdated-selection-link:hover,
.selection-link:hover {
  text-decoration: none;
}

.outdated-selection-link:before,
.selection-link:before {
  border: 5px solid transparent;
  content: '';
  height: 0;
  margin-top: -5px;
  margin-right: -5px;
  position: absolute;
  right: 1px;
  top: 50%;
  width: 0;
}

.selection-link:hover {
  background-color: #3b5998;
}

.outdated-selection-link {
  background-color: #f0babe;
  font-size: 21px;
  font-weight: 800;
  line-height: 27px;
}

.outdated-selection-link:hover:after {
  content: "This selection content has changed since this link was created.";
  font: 9pt/11pt var(--body-font-family);
  position: absolute;
  display: block;
  white-space: nowrap;
  padding: 2px 5px 1px;
  top: -20px;
  background: black;
  color: white;
}

/* Links */

a {
  color: #3B5998;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

/* Images */

img {
  max-width: 100%;
}

/* Section headers */

h1, h2, h3, h4, h5, h6 {
  font-weight: bold;
  margin: 3em 0 1em;
  position: relative;
}

.spec-definition-head {
  font-family: var(--mono-font-family);
}

.spec-definition-head > .spec-secid {
  font-family: var(--body-font-family);
}

@media (min-width: 720px) {
  header > h1 {
    margin: 6em 0 3em;
  }
}

h1 {
  font-size: 1.5em;
  margin-top: 5em;
}

h2, h3 {
  font-size: 1.25em;
}

h4, h5, h6 {
  font-size: 1em;
}

section {
  padding-top: 1rem;
  margin-top: -1rem;
}

section.subsec > h6 {
  margin-top: 2em;
}

section.subsec > h6 > a {
  color: #333333;
}

section .spec-secid {
  margin-right: 1ex;
}

@media (min-width: 720px) {
  section .spec-secid {
    position: absolute;
    right: 100%;
    text-align: right;
    white-space: nowrap;
  }
}

footer {
  font-size: 75%;
  opacity: 0.5;
  text-align: center;
  margin-top: 12rem;
}


/* Table of contents */

.spec-toc {
  margin: 1rem 0 3rem;
}

.spec-toc .title {
  content: 'Contents';
  display: block;
  font-weight: bold;
  margin: 5em 0 1em;
}

.spec-toc .spec-secid {
  margin-right: 1ex;
}

.spec-toc ol {
  list-style: none;
  padding-left: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.spec-toc ol ol {
  list-style: none;
  padding-left: 2ex;
  margin-bottom: 0.25em;
}

.spec-toc li {
  position: relative;
  padding: 5px 0 0 30px;
  margin: -5px 0 0 -30px;
}

.spec-toc a {
  color: #333333;
}

.spec-toc a:hover {
  text-decoration: none;
}

.spec-toc a .spec-secid {
  color: #3B5998;
}

.spec-toc a:hover .spec-secid {
  text-decoration: underline;
}

.spec-toc .toggle {
  display: none;
}

.spec-toc .toggle + label {
  cursor: pointer;
  left: 6px;
  opacity: 1;
  padding: 5px 6px 5px 7px;
  position: absolute;
  top: 6px;
  transform: rotate(0deg);
  transition: all 0.18s ease-in-out;
}

.spec-toc .toggle + label:after {
  border-color: transparent transparent transparent #bbc;
  border-style: solid;
  border-width: 6px 0 6px 7px;
  content: ' ';
  display: block;
  height: 0;
  width: 0;
}

@media(pointer: fine) {
  .spec-toc .toggle + label {
    left: 10px;
    padding: 3px 5px 3px 6px;
    top: 8px;
  }
}

.spec-toc .toggle:checked + label {
  transform: rotate(90deg);
}

@media(hover: hover) {
  .spec-toc li:not(:hover) > .toggle:checked + label {
    opacity: 0;
  }
}

.spec-toc .toggle:not(:checked) ~ ol {
  max-height: 0;
  overflow: hidden;
  margin: 0;
}


/* Sidebar */

.spec-sidebar-toggle {
  display: none;
}

.spec-sidebar-toggle + label > .spec-sidebar-button {
  position: fixed;
  right: 0;
  top: 0;
  padding: 10px 15px;
  font-size: 30px;
  color: rgba(0,0,0,0.7);
  z-index: 2;
  cursor: pointer;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}

.spec-sidebar-toggle:checked + label:after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 0;
}

.spec-sidebar {
  display: none;
  position: fixed;
  right: 0;
  top: 0;
  width: var(--sidebar-width);
  font-size: 14px;
  line-height: 1.75;
  overflow-y: scroll;
  height: 100%;
  padding: 0 0 5rem 30px;
  box-sizing: border-box;
  background: #f0f0f0;
  box-shadow:
    inset 1px 0 rgba(0,0,0,0.05),
    -4px 0 8px -2px rgba(0,0,0,0.04);
  overscroll-behavior: contain;
}

.spec-sidebar {
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}

.spec-sidebar-toggle:checked ~ .spec-sidebar {
  display: block;
}

.spec-sidebar .viewing > a:after {
  color: #8b9;
  content: '\2022';
  margin-left: 1ex;
}

@media (min-width: 1220px) {
  .spec-sidebar-toggle + label {
    display: none;
  }

  .spec-sidebar {
    display: block;
    box-shadow:
      inset 1px 0 rgba(0,0,0,0.05),
      inset 4px 0 8px -2px rgba(0,0,0,0.08) !important;
  }

  body {
    padding-right: 345px;
  }
}


/* Notes */

.spec-note {
  background: #FEFEF3;
  border-left: solid 4px #F4E925;
  margin: 1rem -1rem;
  min-width: 70vw;
  padding: 8px 1rem 12px calc(1rem - 4px);
  width: -moz-fit-content;
  width: -webkit-fit-content;
  width: fit-content;
}

@media (min-width: 720px) {
  .spec-note {
    min-width: 416px;
  }
}

.spec-note > a:first-child {
  color: #6C6613;
  display: block;
  font: italic 11pt/18pt var(--body-font-family);
  opacity: 0.6;
  user-select: none;
}


/* Todos */

.spec-todo {
  color: #666666;
  margin: 1em 0 1em 5em;
  min-height: 1em;
}

.spec-todo::before {
  content: 'todo';
  display: block;
  float: left;
  margin-left: -5em;
  text-transform: uppercase;
}

/* Index table */

.spec-index ol {
  list-style-type: none;
  margin: 0 0 0 var(--indent);
  padding: 0;
  column-width: 210px;
  column-gap: var(--indent);
}

.spec-index ol li {
  width: min-content;
}

/* Code */

pre, code {
  font-family: var(--mono-font-family);
  font-size: var(--mono-font-size);
  font-weight: inherit;
}

code {
  background: #FAFAFA;
  margin: -2px -1px;
  padding: 3px 3px;
  white-space: pre-wrap;
}

pre > code {
  background: none;
  font-weight: inherit;
  margin: 0;
  padding: 0;
  white-space: pre;
}

pre {
  background: #FAFAFA;
  min-width: 70vw;
  width: -moz-fit-content;
  width: -webkit-fit-content;
  width: fit-content;
  max-width: calc(100vw - 2rem);
  overflow-y: scroll;
}

figure {
  border-left: solid 4px #E9E9E9;
  margin: 1rem -1rem;
  padding: 12px 1rem 12px calc(1rem - 4px);
}

.mermaid > svg {
  display: block;
  margin: auto;
}

@media (min-width: 720px) {
  pre {
    min-width: 40ch;
  }
}

.spec-example {
  background: #FAFAFF;
  border-left: solid 4px #BBBBFF;
  padding-top: 8px;
}

.spec-counter-example {
  background: #FFFAFA;
  border-left: solid 4px #FFBBBB;
  padding-top: 8px;
}

figcaption {
  font: italic 11pt/18pt var(--body-font-family);
  text-align: right;
}

figcaption code {
  font-size: 10pt;
}

.spec-example-num {
  display: block;
  float: left;
  opacity: 0.6;
  user-select: none;
}

.spec-counter-example > figcaption > a {
  color: #98593b;
}


/* Tables */

table {
  border-collapse: collapse;
}

th {
  background-color: #F9F9F9;
}

td, th {
  border: 1px solid #D0D0D0;
  padding: 0.4em;
  vertical-align: baseline;
}


/* Lists */

ol, ul {
  padding-left: var(--list-indent);
}

li > ol, li > ul {
  margin-top: 0.25em;
  margin-bottom: 0.5em;
}

li + li {
  margin-top: 0.25em;
}

li.task {
  list-style-type: none;
  position: relative;
}

li.task > input:first-child {
  margin-left: 0;
  position: absolute;
  transform: translateX(calc(-100% - 1ch));
}


/* Edits */

ins {
  background-color: rgba(0, 200, 30, 0.08);
  text-decoration: none;
}

del {
  background-color: rgba(200, 0, 0, 0.08);
}

.spec-added, .spec-removed {
  border-left: 4px solid;
  margin-left: -18px;
  padding-left: 14px;
}

.spec-added {
  border-color: #396;
}

.spec-removed {
  border-color: #933;
  text-decoration: line-through;
}


/* Values */

.spec-keyword {
  font-weight: bold;
}

.spec-string {
  font-family: var(--mono-font-family);
  font-size: 85%;
  white-space: pre;
}

var {
  font-style: italic;
}

*[data-name] {
  transition: 0.15s background ease-out, 0.15s border-color ease-out;
  border-radius: 2px;
  border: 1px solid transparent;
  padding: 0 3px;
  margin: 0 -3px;
}


/* Grammar semantics, algorithms and calls */

.spec-semantic,
.spec-algo {
  margin: 1rem 0 1rem var(--grammar-indent);
}

.spec-semantic > .spec-nt::after,
.spec-algo > .spec-call:first-child::after {
  content: ':';
  font-style: normal;
  font-weight: bold;
  margin-left: 1ex;
}

.spec-semantic ol, .spec-semantic ol ol ol ol,
.spec-algo ol, .spec-algo ol ol ol ol {
  list-style-type: decimal;
}

.spec-semantic ol ol, .spec-semantic ol ol ol ol ol,
.spec-algo ol ol, .spec-algo ol ol ol ol ol {
  list-style-type: lower-alpha;
}

.spec-semantic ol ol ol, .spec-semantic ol ol ol ol ol ol,
.spec-algo ol ol ol, .spec-algo ol ol ol ol ol ol {
  list-style-type: lower-roman;
}

.spec-call > a {
  color: inherit;
}


/* Grammar productions */

.spec-production {
  margin: 1rem 0 1rem var(--grammar-indent);
}

.spec-production > .spec-nt::after {
  content: ':';
  font-style: normal;
  font-weight: bold;
  margin: 0 1ex;
}

.spec-semantic.d2 > .spec-nt::after,
.spec-production.d2 > .spec-nt::after {
  content: '::';
}

.spec-semantic.d3 > .spec-nt::after,
.spec-production.d3 > .spec-nt::after {
  content: ':::';
}

.spec-production > .spec-rhs {
  line-height: 1.1;
  margin: 0.25em 0 0.5em calc(2 * var(--indent));
  text-indent: calc(-1 * var(--indent));
}

.spec-semantic > .spec-rhs {
  display: inline-block;
  text-indent: calc(-1 * var(--indent));
  margin-left: calc(1ex + var(--indent));
}

.spec-rhs > * {
  text-indent: 0;
}

.spec-oneof {
  display: inline;
}

.spec-oneof::before {
  content: 'one of';
  font-style: normal;
  font-weight: bold;
}

.spec-oneof-grid {
  max-width: calc(100vw - 2rem);
  overflow: scroll;
  margin: -1ex -1rem;
  padding: 1ex 1rem;
}

.spec-oneof-grid > table {
  margin-left: var(--indent);
}

.spec-oneof .spec-rhs {
  border: none;
  margin: 0;
  padding: 0 0 0 1rem;
  vertical-align: baseline;
  white-space: pre;
}

.spec-oneof .spec-rhs:first-child {
  padding: 0;
}

.spec-rhs .spec-constrained:not(:first-child),
.spec-rhs .spec-quantified:not(:first-child),
.spec-rhs .spec-nt:not(:first-child),
.spec-rhs .spec-t:not(:first-child),
.spec-rhs .spec-rx:not(:first-child),
.spec-rhs .spec-prose:not(:first-child),
.spec-rhs .spec-empty:not(:first-child),
.spec-rhs .spec-lookahead:not(:first-child) {
  margin-left: 1ex;
  display: inline-block;
}

.spec-condition {
  font-size: 85%;
}

.spec-condition::before {
  content: '[if '
}

.spec-condition.not::before {
  content: '[if not '
}

.spec-condition::after {
  content: ']'
}

.spec-empty,
.spec-prose {
  color: #666666;
}

.spec-nt {
  font-style: italic;
}

.spec-nt > a {
  color: inherit;
}

.spec-quantifiers,
.spec-params {
  font-size: 65%;
  font-style: normal;
  vertical-align: sub;
}

.spec-quantifier.list {
  color: #3348D3;
}

.spec-quantifier.optional {
  color: #83238E;
}

.spec-params,
.spec-condition {
  color: #1C7758;
}

.spec-params::before {
  content: '[';
}

.spec-params::after {
  content: ']';
}

.spec-quantifier:not(:last-child)::after,
.spec-param:not(:last-child)::after {
  color: #666666;
  content: ', ';
}

.spec-param.conditional::before {
  content: '?';
}

.spec-param.negated::before {
  content: '!';
}

.spec-t, .spec-rx {
  color: #333333;
  font-family: monospace;
  font-weight: bold;
}

.spec-butnot::before {
  color: #666666;
  content: 'but not';
  font-family: var(--body-font-family);
  font-weight: normal;
  margin-right: 1ex;
}

.spec-butnot > *:not(:first-child)::before {
  color: #666666;
  content: 'or';
  font-family: var(--body-font-family);
  font-weight: normal;
  margin-right: 1ex;
}

.spec-rhs .spec-oneof::before,
.spec-rhs .spec-butnot::before {
  margin-left: 1ex;
}

.spec-lookahead > * {
  margin: 0 !important;
}

.spec-lookahead > *:not(:first-child)::before {
  color: #666666;
  content: ', ';
  font-family: var(--body-font-family);
  font-style: normal;
  font-weight: normal;
}

.spec-lookahead::before {
  color: #666666;
  content: '[lookahead = ';
  font-family: var(--body-font-family);
  font-style: normal;
  font-weight: normal;
}

.spec-lookahead.not::before {
  content: '[lookahead \2260  ';
}

.spec-lookahead.set::before {
  content: '[lookahead \2208  {';
  margin-right: 0;
}

.spec-lookahead.set.not::before {
  content: '[lookahead \2209  {';
}

.spec-lookahead.ntset::before {
  content: '[lookahead \2208  ';
  margin-right: 0;
}

.spec-lookahead.ntset.not::before {
  content: '[lookahead \2209  ';
}

.spec-lookahead::after {
  color: #666666;
  content: ']';
}

.spec-lookahead.set::after {
  content: '}]';
}

/** RFC 2119 Requirements **/

.spec-requirement {
  font-variant: small-caps;
  text-transform: lowercase;
  color: black;
}</style>
<style>
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
</style>
<script>(function(){var e,t=document.getElementsByTagName("style")[0].sheet;function n(){e&&(t.deleteRule(e),e=void 0)}document.documentElement.addEventListener("mouseover",(function(o){var a,r=o.target.attributes["data-name"];r&&(a=r.value,n(),e=t.insertRule(`*[data-name="${a}"] {\n      background: var(--highlight-background);\n      border-color: var(--highlight-border-color);\n    }`,t.cssRules.length))})),document.documentElement.addEventListener("mouseout",n);})()</script>
<script>(function(){var e,t,n,o,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function a(e){c(new URL(e.target.href))}function i(){c(window.location)}function c(e){var t=e.hash.match(/^#sel-([A-Za-z0-9-_]+)$/);if(t){o=t[1];var a=(n=function(e){for(var t=new Array(64),n=0;n<64;n++)t[r.charCodeAt(n)]=n;var o=0,a=w(),i=w(),c=w(),d=v(),l=i.pop(),f=s(a.concat(i)),h=c.pop(),g=s(a.concat(c)),m=document.createRange();return m.setStart(f,l),m.setEnd(g,h),m.isOutdated=void 0!==d&&d!==u(m.toString()),m;function v(){for(var n=0,r=0;o<e.length;){var a=t[e.charCodeAt(o++)];if(n|=(31&a)<<r,r+=5,a<32)return n}}function w(){var e=v();if(null!=e){for(var t=new Array(e),n=0;n<e;n++)t[n]=v();return t}}}(o)).getBoundingClientRect(),i=Math.max(20,Math.floor(.4*(window.innerHeight-a.height)));window.scrollTo({left:0,top:window.scrollY+a.y-i,behavior:"smooth"});var c=document.getSelection();c.empty(),c.addRange(n),d()}}function d(){if(!n)return;t||(t=document.getElementsByTagName("article")[0]),e||(e=document.createElement("a"),document.body.appendChild(e)),e.href="#sel-"+o,e.onclick=a,e.className=n.isOutdated?"outdated-selection-link":"selection-link",e.innerText=n.isOutdated?"!":"‟";const r=n.getClientRects()[0];e.style.left=`calc(${r.x+window.scrollX}px - 0.75em)`,e.style.top=`calc(${r.y+window.scrollY}px - 0.75em)`}function l(e){for(var t=[];e!=document.body;){var n=e.parentNode;t.push(Array.prototype.indexOf.call(n.childNodes,e)),e=n}return t.reverse()}function s(e){for(var t=document.body,n=0;n<e.length&&t;n++)t=t.childNodes[e[n]];return t}function u(e){for(var t=2166136261,n=0;n<e.length;++n)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return 32767&(t>>15^t)}document.addEventListener("selectionchange",(function(t){var a=document.getSelection();if(a.isCollapsed)e&&(e.parentNode.removeChild(e),e=null);else{var i=a.getRangeAt(0);n&&0===i.compareBoundaryPoints(Range.START_TO_START,n)&&0===i.compareBoundaryPoints(Range.END_TO_END,n)||(o=function(e){var t="",n=l(e.startContainer),o=l(e.endContainer),a=function(e,t){var n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];)n++;return e.slice(0,n)}(n,o);return c(a),c(n.slice(a.length).concat(e.startOffset)),c(o.slice(a.length).concat(e.endOffset)),i(u(e.toString())),t;function i(e){do{t+=r[31&e|(e>31?32:0)],e>>=5}while(e>0)}function c(e){i(e.length);for(var t=0;t<e.length;t++)i(e[t])}}(n=i),d())}})),window.addEventListener("resize",d),window.addEventListener("hashchange",i),window.addEventListener("load",(async()=>{await function(e=100,t=200){return new Promise((n=>{setTimeout(a,t);let o=setTimeout(a,e);const r=new MutationObserver((()=>{clearTimeout(o),o=setTimeout(a,e)}));function a(){n(),r.disconnect()}r.observe(document.getElementsByTagName("article")[0],{childList:!0,subtree:!0})}))}(),i()}));})()</script>
</head>
<body><article>
<header>
<h1>Join</h1>
<section id="intro">
<p><h2>for defining <em>supergraphs</em> which join multiple <em>subgraphs</em></h2></p>
<table class=spec-data>
  <tr><td>Status</td><td>Release</td>
  <tr><td>Version</td><td>0.1</td>
</table>
<link rel=stylesheet href=https://specs.apollo.dev/apollo-light.css>
<script type=module async defer src=https://specs.apollo.dev/inject-logo.js></script>
<figure id="fig-Schema-joining-multiple-subgraphs"><figcaption><a href="#fig-Schema-joining-multiple-subgraphs"> Schema joining multiple subgraphs</a></figcaption><div class=mermaid>graph LR
  classDef bg fill:none,color:#22262E;
  s1(auth.graphql):::bg-->core(composed schema: photos.graphql)
  s2(images.graphql):::bg-->core
  s3(albums.graphql):::bg-->core
  style core fill:none,stroke:fuchsia,color:fuchsia;
</div></figure><p>This document defines a <a href="https://specs.apollo.dev/core/v0.1">core schema</a> named <code>join</code> for describing <a href="https://specs.apollo.dev/core/v0.1">core schemas</a> which <strong>join</strong> multiple <strong>subgraph</strong> schemas into a single <strong>supergraph</strong> schema.</p>
<p>This specification provides machinery to:</p>
<ul>
<li>define <a href="#def-subgraph">subgraphs</a> with the <var data-name="join__Graph">join__Graph</var> enum and the <span class="spec-call"><span data-name="@join__graph">@join__graph</span></span> directive</li>
<li>assign fields to subgraphs with the <span class="spec-call"><span data-name="@join__field">@join__field</span></span> directive</li>
<li>declare additional data required and provided by subgraph field resolvers with the <code>requires</code> and <code>provides</code> arguments to <span class="spec-call"><span data-name="@join__field">@join__field</span></span></li>
<li>assign <a href="#sec-Owned-fields-on-owned-types">keys and ownership</a> to types with the <span class="spec-call"><span data-name="@join__type">@join__type</span></span> and <span class="spec-call"><span data-name="@join__owner">@join__owner</span></span> directives</li>
</ul>
</section>
<nav class="spec-toc">
<div class="title">Contents</div>
<ol>
<li><a href="#sec-How-to-read-this-document"><span class="spec-secid">1</span>How to read this document</a><ol>
<li><a href="#sec-What-this-document-isn-t"><span class="spec-secid">1.1</span>What this document isn&#x27;t</a></li>
</ol>
</li>
<li><a href="#sec-Example-Photo-Library"><span class="spec-secid">2</span>Example: Photo Library</a></li>
<li><a href="#sec-Actors"><span class="spec-secid">3</span>Actors</a></li>
<li><a href="#sec-Overview"><span class="spec-secid">4</span>Overview</a><ol>
<li><a href="#sec-Root-fields"><span class="spec-secid">4.1</span>Root fields</a></li>
<li><a href="#sec-Fields-on-the-same-subgraph-as-the-parent-operation"><span class="spec-secid">4.2</span>Fields on the same subgraph as the parent operation</a></li>
<li><a href="#sec-Fields-provided-by-the-parent-field"><span class="spec-secid">4.3</span>Fields provided by the parent field</a></li>
<li><a href="#sec-Fields-on-value-types"><span class="spec-secid">4.4</span>Fields on value types</a></li>
<li><a href="#sec-Owned-fields-on-owned-types"><span class="spec-secid">4.5</span>Owned fields on owned types</a></li>
<li><a href="#sec-Extension-fields-on-owned-types"><span class="spec-secid">4.6</span>Extension fields on owned types</a></li>
</ol>
</li>
<li><a href="#sec-Basic-Requirements"><span class="spec-secid">5</span>Basic Requirements</a></li>
<li><a href="#sec-Enums"><span class="spec-secid">6</span>Enums</a><ol>
<li><a href="#join__Graph"><span class="spec-secid">6.1</span>join__Graph</a></li>
</ol>
</li>
<li><a href="#sec-Directives"><span class="spec-secid">7</span>Directives</a><ol>
<li><a href="#@join__graph"><span class="spec-secid">7.1</span>@join__graph</a></li>
<li><a href="#@join__type"><span class="spec-secid">7.2</span>@join__type</a></li>
<li><a href="#@join__field"><span class="spec-secid">7.3</span>@join__field</a></li>
<li><a href="#@join__owner"><span class="spec-secid">7.4</span>@join__owner</a></li>
</ol>
</li>
</ol>
</nav>
</header>
<section id="sec-How-to-read-this-document" secid="1">
<h1><span class="spec-secid" title="link to this section"><a href="#sec-How-to-read-this-document">1</a></span>How to read this document</h1>
<p>This document uses <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a> guidance regarding normative terms: <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> / <a href="https://tools.ietf.org/html/rfc2119#section-2" class="spec-requirement not required">MUST NOT</a> / <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">REQUIRED</a> / <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">SHALL</a> / <a href="https://tools.ietf.org/html/rfc2119#section-2" class="spec-requirement not required">SHALL NOT</a> / <a href="https://tools.ietf.org/html/rfc2119#section-3" class="spec-requirement recommended">SHOULD</a> / <a href="https://tools.ietf.org/html/rfc2119#section-4" class="spec-requirement not recommended">SHOULD NOT</a> / <a href="https://tools.ietf.org/html/rfc2119#section-3" class="spec-requirement recommended">RECOMMENDED</a> / <a href="https://tools.ietf.org/html/rfc2119#section-5" class="spec-requirement optional">MAY</a> / <a href="https://tools.ietf.org/html/rfc2119#section-5" class="spec-requirement optional">OPTIONAL</a>.</p>
<section id="sec-What-this-document-isn-t" secid="1.1">
<h2><span class="spec-secid" title="link to this section"><a href="#sec-What-this-document-isn-t">1.1</a></span>What this document isn&#x27;t</h2>
<p>This document specifies only the structure and semantics of supergraphs. It&rsquo;s expected that a supergraph will generally be the output of a compilation process which composes subgraphs. The mechanics of that process are not specified normatively here. Conforming implementations may choose any approach they like, so long as the result conforms to the requirements of this document.</p>
</section>
</section>
<section id="sec-Example-Photo-Library" secid="2">
<h1><span class="spec-secid" title="link to this section"><a href="#sec-Example-Photo-Library">2</a></span>Example: Photo Library</h1>
<p><em>This section is non&#8208;normative.</em></p>
<p>We&rsquo;ll refer to this example of a photo library throughout the document:</p>
<figure id="example-Photos-library-composed-schema" class="spec-example"><figcaption><a href="#example-Photos-library-composed-schema"><span class="spec-example-num">Example № 1</span> Photos library composed schema</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">schema</span>
  <span class="token directive function">@core</span><span class="token punctuation">(</span><span class="token attr-name">feature</span><span class="token punctuation">:</span> <span class="token string">"https://specs.apollo.dev/core/v1.0"</span><span class="token punctuation">)</span>
  <span class="token directive function">@core</span><span class="token punctuation">(</span><span class="token attr-name">feature</span><span class="token punctuation">:</span> <span class="token string">"https://specs.apollo.dev/join/v1.0"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">query</span><span class="token punctuation">:</span> Query
<span class="token punctuation">}</span>

<span class="token keyword">directive</span> <span class="token directive function">@core</span><span class="token punctuation">(</span><span class="token attr-name">feature</span><span class="token punctuation">:</span> String<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token keyword">repeatable</span> <span class="token keyword">on</span> <span class="token class-name">SCHEMA</span>

<span class="token keyword">directive</span> <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">OBJECT</span>

<span class="token keyword">directive</span> <span class="token directive function">@join__type</span><span class="token punctuation">(</span>
  <span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph<span class="token operator">!</span>
  <span class="token attr-name">key</span><span class="token punctuation">:</span> String<span class="token operator">!</span>
<span class="token punctuation">)</span> <span class="token keyword">repeatable</span> <span class="token keyword">on</span> <span class="token class-name">OBJECT</span> <span class="token operator">|</span> <span class="token constant">INTERFACE</span>

<span class="token keyword">directive</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span>
  <span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph
  <span class="token attr-name">requires</span><span class="token punctuation">:</span> String
  <span class="token attr-name">provides</span><span class="token punctuation">:</span> String
<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">FIELD_DEFINITION</span>

<span class="token keyword">directive</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> String<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> String<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">ENUM_VALUE</span>

<span class="token keyword">enum</span> <span class="token class-name">join__Graph</span> <span class="token punctuation">{</span>
  <span class="token constant">AUTH</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"auth"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://auth.api.com"</span><span class="token punctuation">)</span>
  <span class="token constant">ALBUMS</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"albums"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://albums.api.com"</span><span class="token punctuation">)</span>
  <span class="token constant">IMAGES</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"images"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://images.api.com"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">me</span><span class="token punctuation">:</span> User <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">)</span>
  <span class="token attr-name">images</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Image<span class="token punctuation">]</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">User</span>
    <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> ID<span class="token operator">!</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">)</span>
  <span class="token attr-name">name</span><span class="token punctuation">:</span> String <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">)</span>
  <span class="token attr-name">albums</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Album<span class="token operator">!</span><span class="token punctuation">]</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Album</span>
    <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> ID<span class="token operator">!</span>
  <span class="token attr-name">user</span><span class="token punctuation">:</span> User
  <span class="token attr-name">photos</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Image<span class="token operator">!</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Image</span>
    <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"url"</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"url"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">url</span><span class="token punctuation">:</span> Url <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
  <span class="token attr-name">type</span><span class="token punctuation">:</span> MimeType <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
  <span class="token attr-name">albums</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Album<span class="token operator">!</span><span class="token punctuation">]</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">scalar</span> <span class="token class-name">Url</span>
<span class="token keyword">scalar</span> <span class="token class-name">MimeType</span>
</code></pre>
</figure><p>The meaning of the <code>@join__*</code> directives is explored in the <a href="#sec-Directives">Directives</a> section.</p>
<p>The example represents <strong>one way</strong> to compose three input schemas, based on <a href="https://www.apollographql.com/docs/federation/federation-spec/">federated composition</a>. These schemas are provided for purposes of illustration only. This spec places no normative requirements on composer input. It does not require that subgraphs use federated composition directives, and it does not place any requirements on <em>how</em> the composer builds a supergraph, except to say that the resulting schema must be a valid supergraph document.</p>
<p>The <a href="./auth.graphql">auth</a> subgraph provides the <code>User</code> type and <code>Query.me</code>.</p>
<figure id="example-Auth-schema" class="spec-example"><figcaption><a href="#example-Auth-schema"><span class="spec-example-num">Example № 2</span> Auth schema</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">type</span> <span class="token class-name">User</span> <span class="token directive function">@key</span><span class="token punctuation">(</span><span class="token attr-name">fields</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> ID<span class="token operator">!</span>
  <span class="token attr-name">name</span><span class="token punctuation">:</span> String
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">me</span><span class="token punctuation">:</span> User
<span class="token punctuation">}</span></code></pre>
</figure><p>The <a href="./images.graphql">images</a> subgraph provides the <code>Image</code> type and <code>URL</code> scalar.</p>
<figure id="example-Images-schema" class="spec-example"><figcaption><a href="#example-Images-schema"><span class="spec-example-num">Example № 3</span> Images schema</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">type</span> <span class="token class-name">Image</span> <span class="token directive function">@key</span><span class="token punctuation">(</span><span class="token attr-name">fields</span><span class="token punctuation">:</span> <span class="token string">"url"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">url</span><span class="token punctuation">:</span> Url
  <span class="token attr-name">type</span><span class="token punctuation">:</span> MimeType
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">images</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Image<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">extend</span> <span class="token keyword">type</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token attr-name">favorite</span><span class="token punctuation">:</span> Image
<span class="token punctuation">}</span>

<span class="token keyword">scalar</span> <span class="token class-name">Url</span>
<span class="token keyword">scalar</span> <span class="token class-name">MimeType</span></code></pre>
</figure><p>The <a href="./albums.graphql">albums</a> subgraph provides the <code>Album</code> type and extends <code>User</code> and <code>Image</code> with album information.</p>
<figure id="example-Albums-schema" class="spec-example"><figcaption><a href="#example-Albums-schema"><span class="spec-example-num">Example № 4</span> Albums schema</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">type</span> <span class="token class-name">Album</span> <span class="token directive function">@key</span><span class="token punctuation">(</span><span class="token attr-name">fields</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> ID<span class="token operator">!</span>
  <span class="token attr-name">user</span><span class="token punctuation">:</span> User
  <span class="token attr-name">photos</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Image<span class="token operator">!</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">extend</span> <span class="token keyword">type</span> <span class="token class-name">Image</span> <span class="token punctuation">{</span>
  <span class="token attr-name">albums</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Album<span class="token operator">!</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">extend</span> <span class="token keyword">type</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token attr-name">albums</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Album<span class="token operator">!</span><span class="token punctuation">]</span>
  <span class="token attr-name">favorite</span><span class="token punctuation">:</span> Album
<span class="token punctuation">}</span></code></pre>
</figure></section>
<section id="sec-Actors" secid="3">
<h1><span class="spec-secid" title="link to this section"><a href="#sec-Actors">3</a></span>Actors</h1>
<figure id="fig-Actors-and-roles-within-an-example-composition-pipeline"><figcaption><a href="#fig-Actors-and-roles-within-an-example-composition-pipeline"> Actors and roles within an example composition pipeline</a></figcaption><div class=mermaid>flowchart TB
    classDef bg fill:#EBE6FF;
    subgraph A [subgraph A]
      schemaA([schema A]):::bg
      style schemaA color:#000
      endpointA([endpoint A]):::bg
      style endpointA color:#000
    end
    style A fill:#FCFDFF,stroke:#CAD0D8,color:#777F8E;
    subgraph B [subgraph B]
      schemaB([schema B]):::bg
      style schemaB color:#000
      endpointB([endpoint B]):::bg
      style endpointB color:#000
    end
    style B fill:#FCFDFF,stroke:#CAD0D8,color:#777F8E;
    subgraph C [subgraph C]
      schemaC([schema C]):::bg
      style schemaC color:#000
      endpointC([endpoint C]):::bg
      style endpointC color:#000
    end
    style C fill:#FCFDFF,stroke:#CAD0D8,color:#777F8E;
    subgraph producer["Producer ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"]
      Composer
      style Composer color:#000
    end
    style producer fill:#FCFDFF,stroke:#CAD0D8,color:#777F8E;
    supergraph([Supergraph]):::bg
    style supergraph color:#000
    subgraph consumer["Consumer ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"]
      Router
      style Router color:#000
    end
    style consumer fill:#FCFDFF,stroke:#CAD0D8,color:#777F8E;
    A-->Composer:::bg
    B-->Composer:::bg
    C-->Composer:::bg
    Composer-->supergraphSchema([Supergraph Schema]):::bg
    style supergraphSchema color:#000
    supergraphSchema-->Router:::bg
    Router-->published([Published Schema]):::bg
    style published color:#000
    published-->Clients:::bg
    style Clients color:#000
    Clients-->Router:::bg
</div></figure><p><a name=def-producer><strong>Producers</strong></a> generate supergraphs. This spec places requirements on supergraph producers.</p>
<p><a name=def-consumer><strong>Consumers</strong></a> consume supergraphs. This spec places requirements on supergraph consumers.</p>
<p><a name=def-composer><strong>Composers</strong> (or <strong>compilers</strong>)</a> are producers which compose subgraphs into a supergraph. This document places no particular requirements on the composition algorithm, except that it must produce a valid supergraph.</p>
<p><a namme=def-router><strong>Routers</strong></a> are consumers which serve a composed schema as a GraphQL endpoint. <em>This definition is non&#8208;normative.</em></p>
<ul>
<li>Graph routers differ from standard GraphQL endpoints in that they are not expected to resolve fields or communicate with (non&#8208;GraphQL) backend services on their own. Instead, graph routers receive GraphQL requests and service them by performing additional GraphQL requests. This spec provides guidance for implementing routers, but does not require particular implementations of query separation or dispatch, nor does it attempt to normatively separate routers from other supergraph consumers.</li>
<li>Routers expose an <a href="https://specs.apollo.dev/core/v0.1/#sec-Parts-of-a-Core-Schema">API schema</a> to clients that is created by transforming the supergraph schema (for example, the <var data-name="join__Graph">join__Graph</var> enum and the directives described in this spec are removed from the API schema). The API schema is used to validate client operations and may be exposed to clients via introspection.</li>
</ul>
<p><a name=def-endpoint><strong>Endpoints</strong></a> are running servers which can resolve GraphQL queries against a schema. In this version of the spec, endpoints must be URLs, typically http/https URLs.</p>
<p><a name=def-subgraph><strong>Subgraphs</strong></a> are GraphQL schemas which are composed to form a supergraph. Subgraph names and metadata are declared within the special <var data-name="join__Graph">join__Graph</var> enum.</p>
<p>This spec does not place any requirements on subgraph schemas. Generally, they may be of any shape. In particular, subgraph schemas do not need to be supergraphs themselves or to follow this spec in any way; neither is it an error for them to do so. Composers <a href="https://tools.ietf.org/html/rfc2119#section-5" class="spec-requirement optional">MAY</a> place additional requirements on subgraph schemas to aid in composition; composers <a href="https://tools.ietf.org/html/rfc2119#section-3" class="spec-requirement recommended">SHOULD</a> document any such requirements.</p>
</section>
<section id="sec-Overview" secid="4">
<h1><span class="spec-secid" title="link to this section"><a href="#sec-Overview">4</a></span>Overview</h1>
<p><em>This section is non&#8208;normative.</em> It describes the motivation behind the directives defined by this specification.</p>
<p>A supergraph schema describes a GraphQL schema that can be served by a router. The router does not contain logic to resolve any of the schema&rsquo;s fields; instead, the supergraph schema contains directives starting with <span class="spec-call"><span data-name="@join__">@join__</span></span> that tell the router which subgraph endpoint can resolve each field, as well as other information needed in order to construct subgraph operations.</p>
<p>The directives described in this specification are designed for a particular query planning algorithm, and so there are some restrictions on how they can be combined that originate from the requirements of this algorithm. For example, this specification describes a concept of <a href="#sec-Owned-fields-on-owned-types">type ownership</a> which exists not because we believe it describes the ideal method of structuring your subgraphs, but because this query planning algorithm depends on type ownership. We hope that future versions of this specification can relax some of these restrictions. </p>
<p>Each supergraph schema contains a list of its included subgraphs. The <a href="#join__Graph"><var data-name="join__Graph">join__Graph</var></a> enum represents this list with an enum value for each subgraph. Each enum value is annotated with a <a href="#@join__graph"><span class="spec-call"><span data-name="@join__graph">@join__graph</span></span></a> directive telling the router what endpoint can be used to reach the subgraph, and giving the subgraph a human&#8208;readable name that can be used for purposes such as query plan visualization and server logs.</p>
<p>To resolve a field, the router needs to know to which subgraphs it can delegate the field&rsquo;s resolution. One explicit way to indicate this in a supergraph schema is by annotating the field with a <a href="#@join__field"><span class="spec-call"><span data-name="@join__field">@join__field</span></span></a> directive specifying which subgraph should be used to resolve that field. (There are other ways of indicating which subgraphs can resolve a field which will be described later.)</p>
<p>In order for the router to send an operation that resolves a given field on a parent object to a subgraph, the operation needs to first resolve the parent object itself. There are several ways to accomplish this, described below. The examples below include abbreviated versions of the supergraph schemas which do not include the <code>schema</code> definition, directive definitions, or the <code>join__Graph</code> definition. This specification does not require the subgraph operations to be the same as those described in these examples; this is just intended to broadly describe the meanings of the directives.</p>
<section id="sec-Root-fields" secid="4.1">
<h2><span class="spec-secid" title="link to this section"><a href="#sec-Root-fields">4.1</a></span>Root fields</h2>
<p>If a field appears at the root of the overall operation (query or mutation), then it can be placed at the root of the subgraph operation.</p>
<figure id="example-Root-fields" class="spec-example"><figcaption><a href="#example-Root-fields"><span class="spec-example-num">Example № 5</span> Root fields</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token comment"># Supergraph schema</span>
<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">fieldA</span><span class="token punctuation">:</span> String <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
  <span class="token attr-name">fieldAlsoFromA</span><span class="token punctuation">:</span> String <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
  <span class="token attr-name">fieldB</span><span class="token punctuation">:</span> String <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">B</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment"># Operation</span>
<span class="token punctuation">{</span> fieldA fieldAlsoFromA fieldB <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On A:</span>
<span class="token punctuation">{</span> fieldA fieldAlsoFromA <span class="token punctuation">}</span>
<span class="token comment">## On B:</span>
<span class="token punctuation">{</span> fieldB <span class="token punctuation">}</span>
</code></pre>
</figure></section>
<section id="sec-Fields-on-the-same-subgraph-as-the-parent-operation" secid="4.2">
<h2><span class="spec-secid" title="link to this section"><a href="#sec-Fields-on-the-same-subgraph-as-the-parent-operation">4.2</a></span>Fields on the same subgraph as the parent operation</h2>
<p>If a field&rsquo;s parent field will be resolved by an operation on the same subgraph, then it can be resolved as part of the same operation, by putting it in a nested selection set on the parent field&rsquo;s subgraph operation. Note that this example contains <span class="spec-call"><span data-name="@join__owner">@join__owner</span></span> and <span class="spec-call"><span data-name="@join__type">@join__type</span></span> directives on an object type; these will be described later.</p>
<figure id="example-Fields-on-the-same-subgraph-as-the-parent-operation" class="spec-example"><figcaption><a href="#example-Fields-on-the-same-subgraph-as-the-parent-operation"><span class="spec-example-num">Example № 6</span> Fields on the same subgraph as the parent operation</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token comment"># Supergraph schema</span>
<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">fieldA</span><span class="token punctuation">:</span> <span class="token constant">X</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">X</span> <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"nestedFieldA"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">nestedFieldA</span><span class="token punctuation">:</span> String <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment"># Operation</span>
<span class="token punctuation">{</span> fieldA <span class="token punctuation">{</span> nestedFieldA <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On A:</span>
<span class="token punctuation">{</span> fieldA <span class="token punctuation">{</span> nestedFieldA <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre>
</figure></section>
<section id="sec-Fields-provided-by-the-parent-field" secid="4.3">
<h2><span class="spec-secid" title="link to this section"><a href="#sec-Fields-provided-by-the-parent-field">4.3</a></span>Fields provided by the parent field</h2>
<p>Sometimes, a subgraph <span class="spec-nt"><span data-name="G">G</span></span> may be capable of resolving a field that is ordinarily resolved in a different subgraph if the field&rsquo;s parent object was resolved in <span class="spec-nt"><span data-name="G">G</span></span>. Consider an example where the <code>Product.priceCents: Int!</code> field is usually resolved by the Products subgraph, which knows the <code>priceCents</code> for every <code>Product</code> in your system. In the Marketing subgraph, there is a <code>Query.todaysPromotion: Product!</code> field. While the Marketing subgraph cannot determine the <code>priceCents</code> of every product in your system, it does know the <code>priceCents</code> of the promoted products, and so the Marketing subgraph can resolve operations like <code>{ todaysPromotion { priceCents } }</code>.</p>
<p>When this is the case, you can include a <code>provides</code> argument in the <code>@join__field</code> listing these &ldquo;pre&#8208;calculated&rdquo; fields. The router can now resolve these fields in the &ldquo;providing&rdquo; subgraph instead of in the subgraph that would usually be used to resolve those fields.</p>
<figure id="example-Provided-fields" class="spec-example"><figcaption><a href="#example-Provided-fields"><span class="spec-example-num">Example № 7</span> Provided fields</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token comment"># Supergraph schema</span>
<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">todaysPromotion</span><span class="token punctuation">:</span> Product<span class="token operator">!</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">MARKETING</span><span class="token punctuation">,</span> <span class="token attr-name">provides</span><span class="token punctuation">:</span> <span class="token string">"priceCents"</span><span class="token punctuation">)</span>
  <span class="token attr-name">randomProduct</span><span class="token punctuation">:</span> Product<span class="token operator">!</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">PRODUCTS</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Product</span> <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">PRODUCTS</span><span class="token punctuation">)</span> <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">PRODUCTS</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> ID<span class="token operator">!</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">PRODUCTS</span><span class="token punctuation">)</span>
  <span class="token attr-name">priceCents</span><span class="token punctuation">:</span> Int<span class="token operator">!</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">PRODUCTS</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment"># Operation showing that `priceCents` is typically resolved on PRODUCTS</span>
<span class="token punctuation">{</span> randomProduct <span class="token punctuation">{</span> priceCents <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On PRODUCTS</span>
<span class="token punctuation">{</span> randomProduct <span class="token punctuation">{</span> priceCents <span class="token punctuation">}</span> <span class="token punctuation">}</span>

<span class="token comment"># Operation showing that `provides` allows `priceCents` to be resolved on MARKETING</span>
<span class="token punctuation">{</span> todaysPromotion <span class="token punctuation">{</span> priceCents <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On MARKETING</span>
<span class="token punctuation">{</span> todaysPromotion <span class="token punctuation">{</span> priceCents <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre>
</figure></section>
<section id="sec-Fields-on-value-types" secid="4.4">
<h2><span class="spec-secid" title="link to this section"><a href="#sec-Fields-on-value-types">4.4</a></span>Fields on value types</h2>
<p>Some types have the property that all of their fields can be resolved by <em>any</em> subgraph that can resolve a field returning that type. These types are called <em>value types</em>. (Imagine a type <code>type T { x: Int, y: String }</code> where every resolver for a field of type <code>T</code> actually produces an object like <code>{x: 1, y: &quot;z&quot;}</code>, and the resolvers for the two fields on <code>T</code> just unpack the values already in the object.) In a supergraph schema, a type is a value type if it does not have a <a href="#@join__owner"><span class="spec-call"><span data-name="@join__owner">@join__owner</span></span></a> directive on it.</p>
<figure id="example-Value-types" class="spec-example"><figcaption><a href="#example-Value-types"><span class="spec-example-num">Example № 8</span> Value types</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token comment"># Supergraph schema</span>
<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">fieldA</span><span class="token punctuation">:</span> <span class="token constant">X</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
  <span class="token attr-name">fieldB</span><span class="token punctuation">:</span> <span class="token constant">X</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">B</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">X</span> <span class="token punctuation">{</span>
  <span class="token attr-name">anywhere</span><span class="token punctuation">:</span> String
<span class="token punctuation">}</span>

<span class="token comment"># Operation</span>
<span class="token punctuation">{</span> fieldA <span class="token punctuation">{</span> anywhere <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On A</span>
<span class="token punctuation">{</span> fieldA <span class="token punctuation">{</span> anywhere <span class="token punctuation">}</span> <span class="token punctuation">}</span>

<span class="token comment"># Operation</span>
<span class="token punctuation">{</span> fieldB <span class="token punctuation">{</span> anywhere <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On B</span>
<span class="token punctuation">{</span> fieldB <span class="token punctuation">{</span> anywhere <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre>
</figure></section>
<section id="sec-Owned-fields-on-owned-types" secid="4.5">
<h2><span class="spec-secid" title="link to this section"><a href="#sec-Owned-fields-on-owned-types">4.5</a></span>Owned fields on owned types</h2>
<p>We&rsquo;ve finally reached the most interesting case: a field that must be resolved by an operation on a different subgraph from the subgraph on which its parent field was resolved. In order to do this, we need a way to tell the subgraph to resolve that parent object. We do this by defining a special root field in the subgraph&rsquo;s schema: <code>Query._entities(representations: [_Any!]!): [_Entity]!</code>. This field takes a list of &ldquo;representations&rdquo; and returns a list of the same length of the corresponding objects resulting from looking up the representations in an application&#8208;dependent way.</p>
<p>What is a representation? A representation is expressed as the scalar type <code>_Any</code>, and can be any JSON object with a top&#8208;level <code>__typename</code> key with a string value. Often, a representation will be something like <code>{__typename: &quot;User&quot;, id: &quot;abcdef&quot;}</code>: the type name plus one or more fields that you can use to look up the object in a database.</p>
<p>There are several ways that the router can calculate a representation to pass to a subgraph. In this specification, all non&#8208;value types have a specific subgraph referred to as its &ldquo;owner&rdquo;, specified via a <code>@join__owner</code> directive on the type. Object types that are not value types are referred to as &ldquo;entities&rdquo;; the type <code>_Entity</code> referenced above is a union defined in each subgraph&rsquo;s schema consisting of the entity types defined by that subgraph. (Only subgraphs which define entities need to define the <code>Query._entities</code> field.) Entity types must also have at least one <code>@join__type</code> directive specifying the owning subgraph along with a <var data-name="key">key</var>. For each additional subgraph which can resolve fields returning that type, there should be exactly one <code>@join__type</code> directive specifying that subgraph along with a <var data-name="key">key</var>, which should be identical to one of the keys specified with the owning subgraph.</p>
<p>A key is a set of fields on the type (potentially including sub&#8208;selections and inline fragments), specified as a string. If a type <code>T</code> is annotated with <code>@join__type(subgraph: G, key: &quot;a b { c }&quot;)</code>, then it must be possible to resolve the full field set provided as a key on subgraph G. Additionally, if you take an object with the structure returned by resolving that field set and add a field <code>__typename: &quot;T&quot;</code>, then you should be able to pass the resulting value as a representation to the <code>Query._entities</code> field on subgraph G.</p>
<p>In order to resolve a field on an entity on the subgraph that owns its parent type, where that subgraph is different from the subgraph that resolved its parent object, the router first resolves a key for that object on the previous subgraph, and then uses that representation on the owning subgraph.</p>
<p>For convenience, you may omit <code>@join__field(graph: A)</code> directives on fields whose parent type is owned by <code>A</code>.</p>
<figure id="example-Owned-fields-on-owned-types" class="spec-example"><figcaption><a href="#example-Owned-fields-on-owned-types"><span class="spec-example-num">Example № 9</span> Owned fields on owned types</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token comment"># Supergraph schema</span>
<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">fieldB</span><span class="token punctuation">:</span> <span class="token constant">X</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">B</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">X</span>
  <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
  <span class="token comment"># As the owner, A is allowed to have more than one key.</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"y z"</span><span class="token punctuation">)</span>
  <span class="token comment"># As non-owners, B and C can only have one key each and</span>
  <span class="token comment"># they must match a key from A.</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">C</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"y z"</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment"># Because A owns X, we can omit @join__field(graph: A)</span>
  <span class="token comment"># from these three fields.</span>
  <span class="token attr-name">x</span><span class="token punctuation">:</span> String
  <span class="token attr-name">y</span><span class="token punctuation">:</span> String
  <span class="token attr-name">z</span><span class="token punctuation">:</span> String
<span class="token punctuation">}</span>

<span class="token comment"># Operation</span>
<span class="token punctuation">{</span> fieldB <span class="token punctuation">{</span> y <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On B. `y` is not available, so we need to fetch B's key for X.</span>
<span class="token punctuation">{</span> fieldB <span class="token punctuation">{</span> x <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment">## On A</span>
<span class="token comment">## $r = [{__typename: "X", x: "some-x-value"}]</span>
<span class="token keyword">query</span> <span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>_Any<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> _entities<span class="token punctuation">(</span><span class="token attr-name">representations</span><span class="token punctuation">:</span> <span class="token variable">$r</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> y <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre>
</figure></section>
<section id="sec-Extension-fields-on-owned-types" secid="4.6">
<h2><span class="spec-secid" title="link to this section"><a href="#sec-Extension-fields-on-owned-types">4.6</a></span>Extension fields on owned types</h2>
<p>The previous section described how to jump from one subgraph to another in order to resolve a field on the subgraph that owns the field&rsquo;s parent type. The situation is a bit more complicated when you want to resolve a field on a subgraph that doesn&rsquo;t own the field&rsquo;s parent type &mdash; what we call an extension field. That&rsquo;s because we no longer have the guarantee that the subgraph you&rsquo;re coming from and the subgraph you&rsquo;re going to share a key in common. In this case, we may need to pass through the owning type.</p>
<figure id="example-Extension-fields-on-owned-types" class="spec-example"><figcaption><a href="#example-Extension-fields-on-owned-types"><span class="spec-example-num">Example № 10</span> Extension fields on owned types</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token comment"># Supergraph schema</span>
<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">fieldB</span><span class="token punctuation">:</span> <span class="token constant">X</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">B</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">X</span>
  <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
  <span class="token comment"># As the owner, A is allowed to have more than one key.</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"y z"</span><span class="token punctuation">)</span>
  <span class="token comment"># As non-owners, B and C can only have one key each and</span>
  <span class="token comment"># they must match a key from A.</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">C</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"y z"</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token attr-name">x</span><span class="token punctuation">:</span> String
  <span class="token attr-name">y</span><span class="token punctuation">:</span> String
  <span class="token attr-name">z</span><span class="token punctuation">:</span> String
  <span class="token attr-name">c</span><span class="token punctuation">:</span> String <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">C</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment"># Operation</span>
<span class="token punctuation">{</span> fieldB <span class="token punctuation">{</span> c <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On B. `c` is not available on B, so we need to eventually get over to C.</span>
<span class="token comment">## In order to do that, we need `y` and `z`... which aren't available on B</span>
<span class="token comment">## either! So we need to take two steps. First we use B's key.</span>
<span class="token punctuation">{</span> fieldB <span class="token punctuation">{</span> x <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment">## On A. We use B's key to resolve our `X`, and we extract C's key.</span>
<span class="token comment">## $r = [{__typename: "X", x: "some-x-value"}]</span>
<span class="token keyword">query</span> <span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>_Any<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> _entities<span class="token punctuation">(</span><span class="token attr-name">representations</span><span class="token punctuation">:</span> <span class="token variable">$r</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> y z <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment">## On C. We can finally look up the field we need.</span>
<span class="token comment">## $r = [{__typename: "X", y: "some-y-value", z: "some-z-value"}]</span>
<span class="token keyword">query</span> <span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>_Any<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> _entities<span class="token punctuation">(</span><span class="token attr-name">representations</span><span class="token punctuation">:</span> <span class="token variable">$r</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> c <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre>
</figure><p>We only need to do this two&#8208;jump process because the fields needed for C&rsquo;s key are not available in B; otherwise a single jump would have worked, like in the owned&#8208;field case.</p>
<p>Sometimes a particular extension field needs its parent object&rsquo;s representation to contain more information than its parent type&rsquo;s key requests. In this case, you can include a <code>requires</code> argument in the field&rsquo;s <code>@join__field</code> listing those required fields (potentially including sub&#8208;selections). <strong>All required fields must be resolvable in the owning subgraph</strong> (this restriction is why <code>requires</code> is only allowed on extension fields).</p>
<figure id="example-Required-fields" class="spec-example"><figcaption><a href="#example-Required-fields"><span class="spec-example-num">Example № 11</span> Required fields</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token comment"># Supergraph schema</span>
<span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">fieldA</span><span class="token punctuation">:</span> <span class="token constant">X</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">X</span>
  <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">)</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
  <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"x"</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token attr-name">x</span><span class="token punctuation">:</span> String
  <span class="token attr-name">y</span><span class="token punctuation">:</span> String
  <span class="token attr-name">z</span><span class="token punctuation">:</span> String <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">B</span><span class="token punctuation">,</span> <span class="token attr-name">requires</span><span class="token punctuation">:</span> <span class="token string">"y"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment"># Operation</span>
<span class="token punctuation">{</span> fieldA <span class="token punctuation">{</span> z <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment"># Generated subgraph operations</span>
<span class="token comment">## On A. `x` is included because it is B's key for `X`; `y`</span>
<span class="token comment">## is included because of the `requires`.</span>
<span class="token punctuation">{</span> fieldA <span class="token punctuation">{</span> x y <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token comment">## On B..</span>
<span class="token comment">## $r = [{__typename: "X", x: "some-x-value", y: "some-y-value"}]</span>
<span class="token keyword">query</span> <span class="token punctuation">(</span><span class="token variable">$r</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>_Any<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> _entities<span class="token punctuation">(</span><span class="token attr-name">representations</span><span class="token punctuation">:</span> <span class="token variable">$r</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> z <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre>
</figure></section>
</section>
<section id="sec-Basic-Requirements" secid="5">
<h1><span class="spec-secid" title="link to this section"><a href="#sec-Basic-Requirements">5</a></span>Basic Requirements</h1>
<p>Schemas using the <code>join</code> core feature <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> be valid <a href="https://specs.apollo.dev/core/v0.1">core schema documents</a> with <span class="spec-call"><span data-name="@core">@core</span></span> directives referencing the <code>core</code> specification and this specification.</p>
<figure id="example-@core-directives-for-supergraphs" class="spec-example"><figcaption><a href="#example-@core-directives-for-supergraphs"><span class="spec-example-num">Example № 12</span> <span class="spec-call"><span data-name="@core">@core</span></span> directives for supergraphs</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">schema</span>
  <span class="token directive function">@core</span><span class="token punctuation">(</span><span class="token attr-name">feature</span><span class="token punctuation">:</span> <span class="token string">"https://specs.apollo.dev/core/v1.0"</span><span class="token punctuation">)</span>
  <span class="token directive function">@core</span><span class="token punctuation">(</span><span class="token attr-name">feature</span><span class="token punctuation">:</span> <span class="token string">"https://specs.apollo.dev/join/v1.0"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">query</span><span class="token punctuation">:</span> Query
<span class="token punctuation">}</span></code></pre>
</figure><p>As described in the <a href="https://specs.apollo.dev/core/v0.1/#sec-Prefixing">core schema specification</a>, your schema may use a prefix other than <code>join</code> for all of the directive and enum names defined by this specification by including an <code>as</code> argument to the <code>@core</code> directive which references this specification. All references to directive and enum names in this specification <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> be interpreted as referring to names with the appropriate prefix chosen within your schema.</p>
<p>In order to use the directives described by this specification, GraphQL requires you to include their definitions in your schema.</p>
<p>Processors <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> validate that you have defined the directives with the same arguments, locations, and <code>repeatable</code> flag as given below.</p>
<figure id="example-2b08b" class="spec-definition"><pre class="graphql" data-language="graphql"><code><span class="token keyword">directive</span> <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">OBJECT</span>

<span class="token keyword">directive</span> <span class="token directive function">@join__type</span><span class="token punctuation">(</span>
  <span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph<span class="token operator">!</span><span class="token punctuation">,</span>
  <span class="token attr-name">key</span><span class="token punctuation">:</span> String<span class="token operator">!</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token keyword">repeatable</span> <span class="token keyword">on</span> <span class="token class-name">OBJECT</span> <span class="token operator">|</span> <span class="token constant">INTERFACE</span>

<span class="token keyword">directive</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span>
  <span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph<span class="token punctuation">,</span>
  <span class="token attr-name">requires</span><span class="token punctuation">:</span> String<span class="token punctuation">,</span>
  <span class="token attr-name">provides</span><span class="token punctuation">:</span> String<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">FIELD_DEFINITION</span>

<span class="token keyword">directive</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> String<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> String<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">ENUM_VALUE</span>
</code></pre>
</figure><p>Processors <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> validate that the schema contains an enum named <var data-name="join__Graph">join__Graph</var>; see <a href="#join__Graph">its section below</a> for other required properties of this enum.</p>
<p>As described in the core specification, all of the directives and enums defined by this schema should be removed from the supergraph&rsquo;s <a href="https://specs.apollo.dev/core/v0.1/#sec-Parts-of-a-Core-Schema">API schema</a>. For example, the <var data-name="join__Graph">join__Graph</var> enum should not be visible via introspection.</p>
</section>
<section id="sec-Enums" secid="6">
<h1><span class="spec-secid" title="link to this section"><a href="#sec-Enums">6</a></span>Enums</h1>
<section id="join__Graph" secid="6.1">
<h2 class="spec-definition-head"><span class="spec-secid" title="link to this section"><a href="#join__Graph">6.1</a></span>join__Graph</h2>
<p>Enumerate subgraphs.</p>
<figure id="example-2603b" class="spec-definition"><pre class="graphql" data-language="graphql"><code><span class="token keyword">enum</span> <span class="token class-name">join__Graph</span>
</code></pre>
</figure><p>Documents <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> define a <var data-name="join__Graph">join__Graph</var> enum. Each enum value describes a subgraph. Each enum value <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> have a <a href="#@join__graph"><span class="spec-call"><span data-name="@join__graph">@join__graph</span></span></a> directive applied to it.</p>
<figure id="example-Using-join__Graph-to-define-subgraphs-and-their-endpoints" class="spec-example"><figcaption><a href="#example-Using-join__Graph-to-define-subgraphs-and-their-endpoints"><span class="spec-example-num">Example № 13</span> Using join__Graph to define subgraphs and their endpoints</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">enum</span> <span class="token class-name">join__Graph</span> <span class="token punctuation">{</span>
  <span class="token constant">AUTH</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"auth"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://auth.api.com"</span><span class="token punctuation">)</span>
  <span class="token constant">ALBUMS</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"albums"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://albums.api.com"</span><span class="token punctuation">)</span>
  <span class="token constant">IMAGES</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"images"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://images.api.com"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
</figure><p>The <var data-name="join__Graph">join__Graph</var> enum is used as input to the <a href="#@join__owner"><span class="spec-call"><span data-name="@join__owner">@join__owner</span></span></a>, <a href="#@join__field"><span class="spec-call"><span data-name="@join__field">@join__field</span></span></a>, and <a href="#@join__type"><span class="spec-call"><span data-name="@join__type">@join__type</span></span></a> directives.</p>
</section>
</section>
<section id="sec-Directives" secid="7">
<h1><span class="spec-secid" title="link to this section"><a href="#sec-Directives">7</a></span>Directives</h1>
<section id="@join__graph" secid="7.1">
<h2 class="spec-definition-head"><span class="spec-secid" title="link to this section"><a href="#@join__graph">7.1</a></span>@join__graph</h2>
<p>Declare subgraph metadata on <var data-name="join__Graph">join__Graph</var> enum values. </p>
<figure id="example-2a036" class="spec-definition"><pre class="graphql" data-language="graphql"><code><span class="token keyword">directive</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> String<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> String<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">ENUM_VALUE</span>
</code></pre>
</figure><figure id="example-Using-@join__graph-to-declare-subgraph-metadata-on-the-join__Graph-enum-values-" class="spec-example"><figcaption><a href="#example-Using-@join__graph-to-declare-subgraph-metadata-on-the-join__Graph-enum-values-"><span class="spec-example-num">Example № 14</span> Using <span class="spec-call"><span data-name="@join__graph">@join__graph</span></span> to declare subgraph metadata on the <var data-name="join__Graph">join__Graph</var> enum values.</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">enum</span> <span class="token class-name">join__Graph</span> <span class="token punctuation">{</span>
  <span class="token constant">AUTH</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"auth"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://auth.api.com"</span><span class="token punctuation">)</span>
  <span class="token constant">ALBUMS</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"albums"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://albums.api.com"</span><span class="token punctuation">)</span>
  <span class="token constant">IMAGES</span> <span class="token directive function">@join__graph</span><span class="token punctuation">(</span><span class="token attr-name">name</span><span class="token punctuation">:</span> <span class="token string">"images"</span><span class="token punctuation">,</span> <span class="token attr-name">url</span><span class="token punctuation">:</span> <span class="token string">"https://images.api.com"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
</figure><p>The <span class="spec-call"><span data-name="@join__graph">@join__graph</span></span> directive <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> be applied to each enum value on <var data-name="join__Graph">join__Graph</var>, and nowhere else. Each application of <span class="spec-call"><span data-name="@join__graph">@join__graph</span></span> <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> have a distinct value for the <code>name</code> argument; this name is an arbitrary non&#8208;empty string that can be used as a human&#8208;readable identifier which may be used for purposes such as query plan visualization and server logs. The <code>url</code> argument is an endpoint that can resolve GraphQL queries for the subgraph.</p>
</section>
<section id="@join__type" secid="7.2">
<h2 class="spec-definition-head"><span class="spec-secid" title="link to this section"><a href="#@join__type">7.2</a></span>@join__type</h2>
<p>Declares an entity key for a type on a subgraph.</p>
<figure id="example-2d2fa" class="spec-definition"><pre class="graphql" data-language="graphql"><code><span class="token keyword">directive</span> <span class="token directive function">@join__type</span><span class="token punctuation">(</span>
  <span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph<span class="token operator">!</span>
  <span class="token attr-name">key</span><span class="token punctuation">:</span> String<span class="token operator">!</span>
<span class="token punctuation">)</span> <span class="token keyword">repeatable</span> <span class="token keyword">on</span> <span class="token class-name">OBJECT</span> <span class="token operator">|</span> <span class="token constant">INTERFACE</span>
</code></pre>
</figure><p>When this directive is placed on a type <code>T</code>, it means that subgraph <code>graph</code> <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> be able to:</p>
<ul>
<li>Resolve selections on objects of the given type that contain the field set in <code>key</code></li>
<li>Use <code>Query._entities</code> to resolve representations of objects containing <code>__typename: &quot;T&quot;</code> and the fields from the field set in <code>key</code></li>
</ul>
<figure id="example-Using-@join__type-to-specify-subgraph-keys" class="spec-example"><figcaption><a href="#example-Using-@join__type-to-specify-subgraph-keys"><span class="spec-example-num">Example № 15</span> Using <span class="spec-call"><span data-name="@join__type">@join__type</span></span> to specify subgraph keys</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">type</span> <span class="token class-name">Image</span>
    <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"url"</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"url"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">url</span><span class="token punctuation">:</span> Url <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
  <span class="token attr-name">type</span><span class="token punctuation">:</span> MimeType <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
  <span class="token attr-name">albums</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Album<span class="token operator">!</span><span class="token punctuation">]</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
</figure><p>Every type with a <span class="spec-call"><span data-name="@join__type">@join__type</span></span> <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> also have a <a href="#@join__owner"><span class="spec-call"><span data-name="@join__owner">@join__owner</span></span></a> directive. Any type with a <a href="#@join__owner"><span class="spec-call"><span data-name="@join__owner">@join__owner</span></span></a> directive <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> have at least one <span class="spec-call"><span data-name="@join__type">@join__type</span></span> directive with the same <code>graph</code> as the <a href="#@join__owner"><span class="spec-call"><span data-name="@join__owner">@join__owner</span></span></a> directive (the &ldquo;owning graph&rdquo;), and <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> have at most one <span class="spec-call"><span data-name="@join__type">@join__type</span></span> directive for each <code>graph</code> value other than the owning graph. Any value that appears as a <code>key</code> in a <span class="spec-call"><span data-name="@join__type">@join__type</span></span> directive with a <code>graph</code> value other than the owning graph must also appear as a <code>key</code> in a <span class="spec-call"><span data-name="@join__type">@join__type</span></span> directive with <code>graph</code> equal to the owning graph.</p>
</section>
<section id="@join__field" secid="7.3">
<h2 class="spec-definition-head"><span class="spec-secid" title="link to this section"><a href="#@join__field">7.3</a></span>@join__field</h2>
<p>Specify the graph that can resolve the field.</p>
<figure id="example-ae811" class="spec-definition"><pre class="graphql" data-language="graphql"><code><span class="token keyword">directive</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span>
  <span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph
  <span class="token attr-name">requires</span><span class="token punctuation">:</span> String
  <span class="token attr-name">provides</span><span class="token punctuation">:</span> String
<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">FIELD_DEFINITION</span>
</code></pre>
</figure><p>The field&rsquo;s parent type <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> be annotated with a <span class="spec-call"><span data-name="@join__type">@join__type</span></span> with the same value of <code>graph</code> as this directive, unless the parent type is a <a href="http://spec.graphql.org/draft/#sec-Root-Operation-Types">root operation type</a>.</p>
<p>If a field is not annotated with <span class="spec-call"><span data-name="@join__field">@join__field</span></span> (or if the <code>graph</code> argument is not provided or <code>null</code>) and its parent type is annotated with <code>@join__owner(graph: G)</code>, then a processor <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> treat the field as if it is annotated with <code>@join__field(graph: G)</code>. If a field is not annotated with <span class="spec-call"><span data-name="@join__field">@join__field</span></span> (or if the <code>graph</code> argument is not provided or <code>null</code>) and its parent type is not annotated with <span class="spec-call"><span data-name="@join__owner">@join__owner</span></span> (ie, the parent type is a value type) then it <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> be resolvable in any subgraph that can resolve values of its parent type.</p>
<figure id="example-Using-@join__field-to-join-fields-to-subgraphs" class="spec-example"><figcaption><a href="#example-Using-@join__field-to-join-fields-to-subgraphs"><span class="spec-example-num">Example № 16</span> Using <span class="spec-call"><span data-name="@join__field">@join__field</span></span> to join fields to subgraphs</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">type</span> <span class="token class-name">User</span>
    <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> ID<span class="token operator">!</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">)</span>
  <span class="token attr-name">name</span><span class="token punctuation">:</span> String <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">)</span>
  <span class="token attr-name">albums</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Album<span class="token operator">!</span><span class="token punctuation">]</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Album</span>
    <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">id</span><span class="token punctuation">:</span> ID<span class="token operator">!</span>
  <span class="token attr-name">user</span><span class="token punctuation">:</span> User
  <span class="token attr-name">photos</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Image<span class="token operator">!</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">Image</span>
    <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"url"</span><span class="token punctuation">)</span>
    <span class="token directive function">@join__type</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">,</span> <span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">"url"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token attr-name">url</span><span class="token punctuation">:</span> Url <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
  <span class="token attr-name">type</span><span class="token punctuation">:</span> MimeType <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
  <span class="token attr-name">albums</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Album<span class="token operator">!</span><span class="token punctuation">]</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">ALBUMS</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
</figure><p>Every field on a root operation type <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> be annotated with <span class="spec-call"><span data-name="@join__field">@join__field</span></span>.</p>
<figure id="example-@join__field-on-root-fields" class="spec-example"><figcaption><a href="#example-@join__field-on-root-fields"><span class="spec-example-num">Example № 17</span> <span class="spec-call"><span data-name="@join__field">@join__field</span></span> on root fields</a></figcaption><pre class="graphql" data-language="graphql"><code><span class="token keyword">type</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>
  <span class="token attr-name">me</span><span class="token punctuation">:</span> User <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">AUTH</span><span class="token punctuation">)</span>
  <span class="token attr-name">images</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Image<span class="token punctuation">]</span> <span class="token directive function">@join__field</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> <span class="token constant">IMAGES</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
</figure><p>The <code>requires</code> argument <a href="https://tools.ietf.org/html/rfc2119#section-1" class="spec-requirement required">MUST</a> only be specified on fields whose parent type has a <a href="#@join__owner"><span class="spec-call"><span data-name="@join__owner">@join__owner</span></span></a> directive specifying a different <code>graph</code> than this <span class="spec-call"><span data-name="@join__field">@join__field</span></span> directive does. All fields (including nested fields) mentioned in this field set must be resolvable in the parent type&rsquo;s owning subgraph. When constructing a representation for a parent object of this field, a router will include the fields selected in this <code>requires</code> argument in addition to the appropriate <code>key</code> for the parent type.</p>
<p>The <code>provides</code> argument specifies fields that can be resolved in operations run on subgraph <code>graph</code> as a nested selection under this field, even if they ordinarily can only be resolved on other subgraphs.</p>
</section>
<section id="@join__owner" secid="7.4">
<h2 class="spec-definition-head"><span class="spec-secid" title="link to this section"><a href="#@join__owner">7.4</a></span>@join__owner</h2>
<p>Specify the graph which owns the object type.</p>
<figure id="example-c2876" class="spec-definition"><pre class="graphql" data-language="graphql"><code><span class="token keyword">directive</span> <span class="token directive function">@join__owner</span><span class="token punctuation">(</span><span class="token attr-name">graph</span><span class="token punctuation">:</span> join__Graph<span class="token operator">!</span><span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token class-name">OBJECT</span>
</code></pre>
</figure><p>The descriptions of <a href="#@join__type"><span class="spec-call"><span data-name="@join__type">@join__type</span></span></a> and <a href="#@join__field"><span class="spec-call"><span data-name="@join__field">@join__field</span></span></a> describes requirements on how <span class="spec-call"><span data-name="@join__owner">@join__owner</span></span> relates to <span class="spec-call"><span data-name="@join__type">@join__type</span></span> and the <code>requires</code> argument to <span class="spec-call"><span data-name="@join__field">@join__field</span></span>.</p>
<div id="note-e448d" class="spec-note">
<a href="#note-e448d">Note</a>
Type ownership is currently slated for removal in a future version of this spec. It is <a href="https://tools.ietf.org/html/rfc2119#section-3" class="spec-requirement recommended">RECOMMENDED</a> that router implementations consider approaches which function in the absence of these restrictions. The <a href="#sec-Owned-fields-on-owned-types">overview</a> explains how the current router&rsquo;s query planning algorithm depends on concept of type ownership. </div>
</section>
</section>
</article>
<footer>
Written in <a href="https://spec-md.com" target="_blank">Spec Markdown</a>.</footer>
<input hidden class="spec-sidebar-toggle" type="checkbox" id="spec-sidebar-toggle" aria-hidden /><label for="spec-sidebar-toggle" aria-hidden><div class="spec-sidebar-button">&#x2630;</div></label>
<div class="spec-sidebar" aria-hidden>
<div class="spec-toc">
<div class="title"><a href="#">Join</a></div>
<ol><li id="_sidebar_1"><a href="#sec-How-to-read-this-document"><span class="spec-secid">1</span>How to read this document</a>
<input hidden class="toggle" type="checkbox" id="_toggle_1" /><label for="_toggle_1"></label>
<ol>
<li id="_sidebar_1.1"><a href="#sec-What-this-document-isn-t"><span class="spec-secid">1.1</span>What this document isn&#x27;t</a></li>
</ol>
</li>
<li id="_sidebar_2"><a href="#sec-Example-Photo-Library"><span class="spec-secid">2</span>Example: Photo Library</a></li>
<li id="_sidebar_3"><a href="#sec-Actors"><span class="spec-secid">3</span>Actors</a></li>
<li id="_sidebar_4"><a href="#sec-Overview"><span class="spec-secid">4</span>Overview</a>
<input hidden class="toggle" type="checkbox" id="_toggle_4" /><label for="_toggle_4"></label>
<ol>
<li id="_sidebar_4.1"><a href="#sec-Root-fields"><span class="spec-secid">4.1</span>Root fields</a></li>
<li id="_sidebar_4.2"><a href="#sec-Fields-on-the-same-subgraph-as-the-parent-operation"><span class="spec-secid">4.2</span>Fields on the same subgraph as the parent operation</a></li>
<li id="_sidebar_4.3"><a href="#sec-Fields-provided-by-the-parent-field"><span class="spec-secid">4.3</span>Fields provided by the parent field</a></li>
<li id="_sidebar_4.4"><a href="#sec-Fields-on-value-types"><span class="spec-secid">4.4</span>Fields on value types</a></li>
<li id="_sidebar_4.5"><a href="#sec-Owned-fields-on-owned-types"><span class="spec-secid">4.5</span>Owned fields on owned types</a></li>
<li id="_sidebar_4.6"><a href="#sec-Extension-fields-on-owned-types"><span class="spec-secid">4.6</span>Extension fields on owned types</a></li>
</ol>
</li>
<li id="_sidebar_5"><a href="#sec-Basic-Requirements"><span class="spec-secid">5</span>Basic Requirements</a></li>
<li id="_sidebar_6"><a href="#sec-Enums"><span class="spec-secid">6</span>Enums</a>
<input hidden class="toggle" type="checkbox" id="_toggle_6" /><label for="_toggle_6"></label>
<ol>
<li id="_sidebar_6.1"><a href="#join__Graph"><span class="spec-secid">6.1</span>join__Graph</a></li>
</ol>
</li>
<li id="_sidebar_7"><a href="#sec-Directives"><span class="spec-secid">7</span>Directives</a>
<input hidden class="toggle" type="checkbox" id="_toggle_7" /><label for="_toggle_7"></label>
<ol>
<li id="_sidebar_7.1"><a href="#@join__graph"><span class="spec-secid">7.1</span>@join__graph</a></li>
<li id="_sidebar_7.2"><a href="#@join__type"><span class="spec-secid">7.2</span>@join__type</a></li>
<li id="_sidebar_7.3"><a href="#@join__field"><span class="spec-secid">7.3</span>@join__field</a></li>
<li id="_sidebar_7.4"><a href="#@join__owner"><span class="spec-secid">7.4</span>@join__owner</a></li>
</ol>
</li>
</ol>
</div>
<script>(function(){var e,t=[],n=document.querySelector('label[for="spec-sidebar-toggle"]');function o(e){e.preventDefault()}n.addEventListener("scroll",o),n.addEventListener("touchmove",o);for(var i=document.getElementsByTagName("section"),r=0;r<i.length;r++)i[r].getAttribute("secid")&&t.push(i[r]);var c=window.scrollY,l=!1;function d(n){for(var o,i=n+document.documentElement.clientHeight/4,r=t.length-1;r>=0;r--)if(t[r].offsetTop<i){o=t[r];break}var c=o&&o.getAttribute("secid");c!==e&&(e&&a(e,!1),c&&a(c,!0),e=c)}function a(e,t){document.getElementById("_sidebar_"+e).className=t?"viewing":"";for(var n=e.split(".");n.length;){var o=document.getElementById("_sidebar_toggle_"+n.join("."));o&&(o.checked=t),n.pop()}}window.addEventListener("scroll",(function(e){c=window.scrollY,l||(l=!0,window.requestAnimationFrame((function(){d(c),l=!1})))})),d(window.scrollY);})()</script>
</div>
<script>(function(){(async function(e){const i=document.querySelector(`script[src="${e}"]`);if(i&&i.__loadingPromise)return i.__loadingPromise;const n=document.createElement("script");return n.async=!0,n.defer=!0,n.setAttribute("::save","off"),n.__loadingPromise=new Promise(((e,i)=>{n.onload=e,n.onerror=i})),n.src=e,document.body.appendChild(n),n.__loadingPromise})("https://unpkg.com/mermaid@^8/dist/mermaid.min.js").then((async()=>{const e=window.mermaid;return console.log("initializing mermaid..."),await e.initialize({securityLevel:"loose",theme:"dark",startOnLoad:!0}),e}));})()</script>
</body>
</html>
